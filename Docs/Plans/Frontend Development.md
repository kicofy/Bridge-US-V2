# 共享 UI 的多端前端开发方案规划（Web + App）

> 适用场景：  
> - 后端已完成，提供独立 API（REST / GraphQL）  
> - 前端 **Web 与 App 分别开发**  
> - 希望 **UI 风格、组件规范一致**  
> - 接受平台内部实现不同，但**对外组件 API 完全一致**

---

## 一、总体目标

### 1.1 核心目标
- Web（React / Next.js）与 App（React Native / Expo）**工程完全独立**
- UI **看起来一致、用法一致**
- 业务逻辑、API、状态 **最大化共享**
- 平台差异 **封装在 UI 内部**

### 1.2 不追求的目标
- ❌ UI 实现 100% 一套代码  
- ❌ Web 被强制使用 React Native 组件  
- ❌ 为了复用牺牲 Web SEO / 原生 App 体验

---

## 二、整体架构选型

### 2.1 技术栈建议
| 层级 | 技术 |
|----|----|
| Web | React / Next.js + TypeScript |
| App | React Native + Expo + TypeScript |
| UI | 自研 UI Design System（方案 1） |
| 状态管理 | Zustand |
| 请求 | Axios / Fetch |
| 包管理 | pnpm workspace（Monorepo） |

---

## 三、Monorepo 目录结构设计

repo/
├─ apps/
│ ├─ web/ # Web 应用（Next.js / React）
│ └─ mobile/ # App 应用（Expo React Native）
│
├─ packages/
│ ├─ tokens/ # 设计 Tokens（颜色 / 间距 / 字体）
│ ├─ ui/ # 共享 UI 组件库（方案核心）
│ ├─ api/ # API client + endpoints + DTO types
│ ├─ store/ # 跨端状态管理
│ ├─ utils/ # 通用工具（storage、format 等）
│
├─ package.json
├─ pnpm-workspace.yaml
└─ tsconfig.base.json

---

## 四、路由与页面规划（基于 Docs/Plans 功能）

### 4.1 公共基础页面
- 首页 / 信息流  
  - 功能：推荐/热门/最新、分类/标签筛选、语言切换  
  - 操作：点击帖子 → 帖子详情；搜索 → 搜索结果；筛选 → 刷新列表
- 搜索结果页  
  - 功能：关键词搜索、过滤（分类/标签/语言）、排序（最新/最有用/最高准确）  
  - 操作：点击结果 → 帖子详情；切换筛选 → 刷新列表
- 分类聚合页 / 标签聚合页  
  - 功能：聚合列表、分页  
  - 操作：点击帖子 → 帖子详情

### 4.2 认证与账号
- 登录页  
  - 功能：邮箱登录  
  - 操作：登录成功 → 回跳上一页或首页；忘记密码 → 忘记密码页
- 注册页  
  - 功能：邮箱注册 + 验证码  
  - 操作：发送验证码 → 注册成功 → 进入个人主页
- 忘记密码页  
  - 功能：邮箱验证码重置密码  
  - 操作：成功后 → 登录页
- 修改密码页  
  - 功能：旧密码 → 新密码  
  - 操作：成功后 → 个人设置页

### 4.3 帖子与内容
- 帖子详情页  
  - 功能：多语言切换、标签展示、有用度/准确度互动、举报  
  - 操作：点赞/评分 → 更新统计；举报 → 弹窗提交
- 发帖页  
  - 功能：标题/正文/分类/标签/语言、发布/草稿  
  - 操作：发布 → 帖子详情；草稿 → 我的帖子
- 编辑帖子页  
  - 功能：编辑已有内容  
  - 操作：保存 → 帖子详情
- 我的帖子  
  - 功能：列表、状态筛选（已发布/审核中/被隐藏/草稿）  
  - 操作：点击 → 详情；编辑 → 编辑页

### 4.4 回复与互动
- 回复列表（嵌入详情页）  
  - 功能：回复列表、点赞、折叠  
  - 操作：点赞 → 更新；点击作者 → 作者主页
- 发布回复（嵌入详情页）  
  - 功能：输入并发布  
  - 操作：发布 → 刷新列表

### 4.5 个人中心
- 个人主页  
  - 功能：基础资料、统计、徽章  
  - 操作：编辑资料 → 资料编辑；认证申请 → 认证页
- 资料编辑  
  - 功能：头像、昵称、学校、地点、简介  
  - 操作：保存 → 个人主页
- 认证申请 / 认证状态  
  - 功能：提交认证、查看进度  
  - 操作：拒绝可重新提交

### 4.6 通知中心
- 通知列表  
  - 功能：未读/已读、批量已读  
  - 操作：点击通知 → 跳转相关内容

### 4.7 举报与申诉
- 我的举报  
  - 功能：举报记录与处理结果  
  - 操作：点击 → 关联内容
- 我的申诉  
  - 功能：申诉记录与结果  
  - 操作：点击 → 申诉详情

### 4.8 AI 功能页
- AI 问答页  
  - 功能：提问与回复  
  - 操作：提交问题 → 显示答案；关联搜索 → 搜索结果

### 4.9 管理后台（Admin / Root）
- 后台首页  
  - 功能：概览统计、快捷入口
- 帖子管理 / 回复管理  
  - 功能：列表、筛选、隐藏/恢复  
  - 操作：点击详情 → 内容详情页
- 举报管理 / 申诉管理  
  - 功能：处理举报、审批申诉  
  - 操作：通过/拒绝 → 自动通知
- 认证管理  
  - 功能：认证队列、审批  
  - 操作：通过/拒绝
- 用户管理  
  - 功能：封禁/解封、查看详情
- 分类/标签管理  
  - 功能：新增/编辑/删除
- 审计日志（Root 专属）  
  - 功能：管理员操作查询与筛选

---

## 五、信息架构与导航

### 5.1 Web 导航建议
- 顶部导航：首页 / 搜索 / 发帖 / 通知 / 个人中心  
- 右侧面板（可选）：热门标签 / 推荐作者 / 趋势

### 5.2 App 导航建议
- 底部 Tab：首页 / 搜索 / 发帖 / 通知 / 我的  
- 详情页使用栈导航（支持返回）

---

## 六、共享 UI 设计系统规划

### 6.0 设计来源与约束
- **视觉效果必须 100% 与** `UI Design` 目录的静态 UI 演示一致
- **实现代码可以不同**（因为 `UI Design` 为静态演示），但最终呈现需完全一致
- 如需修改，仅允许**轻微调整**（间距、字号、颜色细微变化），不得改变整体布局风格
- 设计稿来源：Figma `Forum-Style Social Platform UI`

### 6.1 Design Tokens
- 颜色：主色、强调色、错误/警告/成功  
- 排版：字体族、字号、字重  
- 间距：4/8/12/16/24/32  
- 圆角/阴影：统一规范

### 6.2 组件库范围
- 基础：Button / Input / TextArea / Select / Modal / Toast  
- 业务：PostCard / ReplyItem / TagPill / CategoryBadge  
- 状态：Empty / Loading / Error / Skeleton

---

## 七、状态管理与数据层

### 7.1 Zustand Store 划分
- auth：token、user、角色  
- posts：列表、详情、筛选  
- interactions：点赞/评分状态  
- notifications：未读数、列表  

### 7.2 API Client 约定
- `packages/api`：按模块拆分，统一错误处理  
- Token 过期自动刷新  
- 统一 Response/Errors 类型

---

## 八、多语言与国际化

### 8.1 目标与范围（默认中英）
- 默认支持：`zh` / `en`
- UI 文案与日期格式随语言切换
- 内容层按语言请求（后端返回对应语言内容，缺失则回退原文）

### 8.2 方案选择
- 前端 i18n：`react-i18next`（或同类）
- 语言状态：`app.language`（持久化 localStorage）
- 默认语言：  
  1) 用户手动选择  
  2) 否则读取浏览器语言  
  3) 否则回退 `en`

### 8.3 目录结构建议
- `src/i18n/index.ts`（初始化 i18n）
- `src/i18n/locales/en/common.json`
- `src/i18n/locales/zh/common.json`
- `src/i18n/locales/*/routes.json`（页面级文案可选）

### 8.4 UI 文案替换规范
- 所有 UI 字符串使用 `t('key')`
- 禁止硬编码中英文混用
- 通用组件文案放 `common.json`，页面文案放 `routes.json`

### 8.5 内容语言与接口约定
- 所有帖子/搜索/趋势接口携带 `language` 参数
- `language` 取自全局语言状态
- 后端无翻译时自动回退原文（前端无需处理）

### 8.6 语言切换入口
- 顶部导航语言切换（EN / 中文）
- 个人中心设置页（可选）

---

## 九、权限与访问控制

- 未登录：可浏览、不可发帖/回复/互动  
- 已登录：发帖、回复、互动、举报  
- 管理员：进入后台管理  
- Root：可访问审计日志

---

## 十、质量与交付

### 10.1 测试
- 组件测试：UI 组件快照  
- 集成测试：登录、发帖、评论、通知  

### 10.2 工程化
- ESLint + Prettier + Husky  
- CI：lint + test + build  

---

## 十一、网页背景动画多样化规划

### 11.1 目标与原则
- 视觉风格保持与 `UI Design` 一致，仅做增强
- 低干扰：不影响可读性与交互
- 性能优先：移动端/低性能设备自动降级

### 11.2 动画类型规划
- **Aurora 渐变**：现有基础，作为默认主题
- **Grid Wave**：轻微波动网格，适合主页/搜索页
- **Floating Orbs**：缓慢漂浮光斑，用于个人中心/通知
- **Subtle Noise**：轻噪点增强质感，用于后台/设置
- **Star Dust**：点状粒子缓慢漂移，用于 AI 页面

### 11.3 页面映射建议
- 首页/搜索：Aurora + Grid Wave（轻）
- 帖子详情/发帖：Aurora（弱化）
- AI 问答：Star Dust（弱化）
- 个人中心/通知：Floating Orbs（弱化）
- 管理后台：Subtle Noise（极弱）

### 11.4 技术实现建议
- CSS 动画为主，避免 JS 重绘
- 使用 `prefers-reduced-motion` 自动降低/停用
- 将背景封装为 `BackgroundLayer` 组件
- 支持 `theme` 参数：`aurora | grid | orbs | noise | stars`

### 11.5 性能与降级
- 低端设备/移动端：固定静态背景图
- 隐藏背景动画于表单密集页（如登录/注册）
- 提供全局开关（设置页，可选）

## 十一、开发顺序建议

1. 认证流程（登录/注册/忘记密码）  
2. 首页/搜索/帖子详情  
3. 发帖/回复/互动  
4. 通知中心  
5. 个人中心  
6. 后台管理  
7. 多语言优化与细节完善  